"use strict";!function(t){"function"==typeof define?define(t):"undefined"!=typeof module&&module.exports?module.exports=t():this.NicePassWord=t()}(function(){function t(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=e.type,i=void 0===n?"password":n,s=e.symbol,n=void 0===s?"*":s,s=e.callback,s=void 0===s?function(){}:s,e=e.pattern,e=void 0===e?/([\u4e00-\u9fa5])/g:e,r=this;if(r.input=document.querySelector(t),!r.input||"input"!=r.input.tagName.toLowerCase()||"password"===r.input.type)throw new Error("请传一个type为text的input的id！");return r.input.valueProxy="",r.callback=s,r.type=i,r.symbol=n,r.pattern=e,r.cursor=0,r.isInit=!1,Object.defineProperty(r,"value",{get:function(){return r.input.valueProxy}}),r.init(),r}return t.prototype.init=function(){this.$setValue(),this._preventDefaultEvent(),this._bindEvent(),this.isInit=!0},t.prototype._preventDefaultEvent=function(t){function e(){var t=t||window.event;t.preventDefault()}this.input.addEventListener("copy",e),this.input.addEventListener("cut",e),this.input.addEventListener("dragenter",function(t){return t.preventDefault(),this.warn("_dragenterhandlder"),this.setAttribute("readonly",!0),!1}),this.input.addEventListener("dragleave",function(t){return t.preventDefault(),this.warn("_dragleaveHandler"),this.removeAttribute("readonly"),!1}),this.input.addEventListener("mousedown",function(t){return 0===t.button&&this.selectionStart!=this.selectionEnd&&(this.selectionStart=this.selectionEnd=this.value.length),!1})},t.prototype._bindEvent=function(){var t=this;this.input.addEventListener("compositionstart",function(){t.lock=!0,t.warn("start")}),this.input.addEventListener("compositionend",function(){t.lock=!1,t.warn("end"),t._inputHandler()}),this.input.addEventListener("input",this._inputHandler.bind(this)),this.input.addEventListener("propertychange",this._inputHandler.bind(this))},t.prototype._inputHandler=function(){this.lock||(this.isInit?this.warn("input"):this.warn("init"),"password"===this.type?this._passwordHandler():this._textHandler(),this._showValue(),this._setCursor(),"function"==typeof this.callback&&this.callback())},t.prototype._passwordHandler=function(){var t,e,n=this._filterCn(this.input.value).split(""),i=this.input.valueProxy.split(""),s=n.length-i.length,r=this.input.selectionStart,o=r-this.input.value.split("").length+n.length;0<s&&(t=n.join("").replace(/\*/g,"").split(""),e=0<n.length-r?i.slice(-(n.length-r)):[],i=[].concat(i.slice(0,r-t.length),t,e)),s<0&&i.splice(r,Math.abs(s)),n.forEach(function(t,e){"*"!=t&&(i[e]=t)}),this.input.valueProxy=i.join(""),this.cursor=o},t.prototype._filterCn=function(t,e){if(!t)return t;var n=this.pattern,e=e||"";return t.replace(n,e)},t.prototype._textHandler=function(){this.input.valueProxy=this._filterCn(this.input.value),this.cursor=this.input.selectionStart-this.input.value.split("").length+this.input.valueProxy.split("").length},t.prototype._showValue=function(){var e=this,n="";"password"===this.type?this.value.split("").forEach(function(t){n+=e.symbol}):n=this.value,this.input.value=n},t.prototype._setCursor=function(){this.input.selectionStart=this.cursor,this.input.selectionEnd=this.cursor},t.prototype.warn=function(t){console.log(t)},t.prototype.$setValue=function(t){t&&(this.input.value=t),this._inputHandler()},t.prototype.$changeType=function(t){this.type=t,this.$setValue(this.value)},t});